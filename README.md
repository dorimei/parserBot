# Что это такое

Это телеграм бот, позволяющий отслеживать позицию абитуриентов в рейтинговых списках СГУГиТ. Бот предсотавляет следующие
возможности:

- Предоставление данных о текущей рейтинговой ситуации
- Регулярное обновление списков поступающих
- Оповещение зарегестрированных пользователей об изменении позиции в списках

# Как запустить бот

## Запуск из коммандной строки

Перед запуском бота необходимо создать телеграм бота. Как это сделать, описано
здесь https://botcreators.ru/blog/botfather-instrukciya/
Далее необходимо сохранить ключ API бота.

Создайте новый текстовый файл и назовите его links.txt. Запишите туда все направления подготовки и ссылки на них через
разделитель `;`
Пример готового файла:

```
Информационные системы и технологии, бюджет;https://samelimk.org/test.html
Информационные системы и технологии, контракт;https://samelimk.org/test.html
Информационные системы и технологии, заочка;https://samelimk.org/test.html
```

Склонируйте проект и установите все используемые пакеты командой

`pip install -r requirements.txt`

После этого запустите бота командой

`python bot.py -i 120 -s -n <LINKS_FILE_LOCATION> <API_TOKEN_HERE>`

Аргументы запуска:

* `-i` Интервал обновления данных списков в секундах. По умолчанию 30 секунд
* `-s` Путь до файла хранения состояний. По умолчанию `state.json`
* `-u` Пропустить предыдущие события в телеграм боте, позволяет пропускать все сообщения, отправленные боту во время
  простоя программы. По умолчанию вычитывает все сообщения, даже если бот простаивал.
* `-n` Путь до файла хранения ссылок для парсинга. По умолчанию `links.txt`
* `-v` Включить вывод логов для отладки
* `<API_TOKEN_HERE>>` Токен доступа к API телеграм (выданный BotFather). Данный аргумент является обязательным
* `--help` Помощь по аргументам запуска

## Запуск в Docker

Создайте новый текстовый файл и назовите его links.txt. Запишите туда все направления подготовки и ссылки на них через
разделитель `;`
Пример готового файла:

```
Информационные системы и технологии, бюджет;https://samelimk.org/test.html
Информационные системы и технологии, контракт;https://samelimk.org/test.html
Информационные системы и технологии, заочка;https://samelimk.org/test.html
```

Далее необходимо запустить команду:

``docker run -d --name concurs-visor -e API_TOKEN=<API_TOKEN_HERE> -v /home/user/bot_data:/app/files docker.pckg.github.com/concurs_visor:latest``

Здесь применяется папка `/home/user/bot_data`, где будут храниться файлы состояний и ссылок для парсинга. Перед запуском
команды скопируйте в папку файл ссылок для парсинга и подставьте свой путь до нужной директории.

Доступные переменные для запуска:

* `API_TOKEN` Токен доступа к API телеграм (выданный BotFather). Обязателен
* `STATE_FILE` Путь до файла состояний внутри контейнера. По умолчанию `/app/files/state.json`
* `LINKS_FILE` Путь до файла ссылок для парсинга внутри контейнера. По умолчанию `/app/files/links.txt`